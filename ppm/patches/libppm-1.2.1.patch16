diff --git a/src/neighlist/ppm_neighlist_clist.f b/src/neighlist/ppm_neighlist_clist.f
index 28a3d31..e8c8e49 100644
--- a/src/neighlist/ppm_neighlist_clist.f
+++ b/src/neighlist/ppm_neighlist_clist.f
@@ -163,7 +163,7 @@
       !-------------------------------------------------------------------------
       IF (PRESENT(pidx)) THEN
           lpidx = .TRUE.
-          npidx = SIZE(pidx,1)
+          npidx = np
           iopt = ppm_param_alloc_fit
           ldc(1) = ppm_dim
           ldc(2) = npidx
